(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/addHouse/addHouse"],{"13b6":function(t,e,n){"use strict";n.r(e);var a=n("f6ac"),s=n.n(a);for(var i in a)"default"!==i&&function(t){n.d(e,t,(function(){return a[t]}))}(i);e["default"]=s.a},"5c07":function(t,e,n){"use strict";n.d(e,"b",(function(){return s})),n.d(e,"c",(function(){return i})),n.d(e,"a",(function(){return a}));var a={uniCollapse:function(){return n.e("components/uni-collapse/uni-collapse").then(n.bind(null,"5b28"))},uniCollapseItem:function(){return n.e("components/uni-collapse-item/uni-collapse-item").then(n.bind(null,"787d"))},dhAssets:function(){return n.e("components/dh-assets/dh-assets").then(n.bind(null,"cc3e"))}},s=function(){var t=this,e=t.$createElement;t._self._c},i=[]},a959:function(t,e,n){"use strict";(function(t){n("5401");a(n("66fd"));var e=a(n("ccc6"));function a(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,n("543d")["createPage"])},ccc6:function(t,e,n){"use strict";n.r(e);var a=n("5c07"),s=n("13b6");for(var i in s)"default"!==i&&function(t){n.d(e,t,(function(){return s[t]}))}(i);n("cce7");var o,u=n("f0c5"),c=Object(u["a"])(s["default"],a["b"],a["c"],!1,null,"f7e51f96",null,!1,a["a"],o);e["default"]=c.exports},cce7:function(t,e,n){"use strict";var a=n("effc"),s=n.n(a);s.a},effc:function(t,e,n){},f6ac:function(t,e,n){"use strict";(function(t,a){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var s=i(n("a34a"));function i(t){return t&&t.__esModule?t:{default:t}}function o(t,e,n,a,s,i,o){try{var u=t[i](o),c=u.value}catch(l){return void n(l)}u.done?e(c):Promise.resolve(c).then(a,s)}function u(t){return function(){var e=this,n=arguments;return new Promise((function(a,s){var i=t.apply(e,n);function u(t){o(i,a,s,u,c,"next",t)}function c(t){o(i,a,s,u,c,"throw",t)}u(void 0)}))}}var c={data:function(){return{array:["长租","短租"],index:"",houseType:["单间","1室1厅1卫","2室1厅1卫","3室1厅1卫"],typeIndex:"",direction:["东","西","南","北","东北","东南","西南","西北"],direIndex:"",renovation:["毛坯房","简单装修","精装修"],renIndex:"",deposit:["押一付一","押二付一","押三付一"],depIndex:"",state:["未租","已租"],stateIndex:"",update:!1,assets:[],submitData:{building:"",floor:"",houseNumber:"",area:"",houseType:"",orientation:"",renovation:"",purpose:"",state:"",rent:"",waterPrice:"",electricityPrice:"",pledge:"",cardDeposit:"",waterNum:"",electricityNum:"",water:[],electricity:[],assets:"",address:"",latitude:"",longitude:"",addressName:""}}},onLoad:function(e){if(e.item){var n=JSON.parse(e.item);console.log(n),Object.assign(this.submitData,n),this.assets=n.assets,this.update=!0}this.update?t.setNavigationBarTitle({title:"修改房间"}):t.setNavigationBarTitle({title:"添加房间"})},methods:{change:function(){},bindPickerChange:function(t,e,n,a){console.log(t),this[e]=t.target.value,this.submitData[n]=this[a][t.target.value]},chooseAddress:function(){var e=this;t.chooseLocation({success:function(t){e.submitData.addressName=t.name,e.submitData.address=t.address,e.submitData.latitude=t.latitude,e.submitData.longitude=t.longitude,console.log("位置名称："+t.name),console.log("详细地址："+t.address,e.submitData.address),console.log("纬度："+t.latitude),console.log("经度："+t.longitude)}})},submitHouse:function(){var e=new Date,n=e.getFullYear()+"-"+(e.getMonth()+1).toString().padStart(2,"0")+"-"+e.getDate().toString().padStart(2,"0");if(this.submitData.water.push({date:n,num:this.submitData.waterNum}),this.submitData.electricity.push({date:n,num:this.submitData.electricityNum}),this.update)this.updateHouse();else{t.showLoading({title:"正在提交"});var s=t.getStorageSync("user");this.submitData.createdId=s._id,this.submitData.cloud="house",a.callFunction({name:"add",data:this.submitData}).then((function(e){console.log(e),t.showToast({title:"添加成功"}),t.navigateBack()})).catch((function(e){t.showToast({title:"添加失败",icon:"none"}),console.log(e,"err")}))}},updateHouse:function(){t.showLoading({title:"正在提交"}),this.submitData.assets.constructor==Array&&(this.submitData.assets=this.submitData.assets.join(",")),this.submitData.cloud="house",a.callFunction({name:"update",data:this.submitData}).then((function(e){console.log(e),t.showToast({title:"修改成功"}),t.navigateBack()})).catch((function(e){t.showToast({title:"修改失败",icon:"none"}),console.log(e,"err")}))},assetsChange:function(t){this.assets=t,this.submitData.assets=t.join(","),console.log(this.submitData.assets)},uploadImg:function(){t.chooseImage({count:3,success:function(){var t=u(s.default.mark((function t(e){var n,i,o;return s.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:n=0;case 1:if(!(n<e.tempFilePaths.length)){t.next=11;break}return i=e.tempFiles[n].name.split(".").pop(),console.log("item",e.tempFilePaths[n]),t.next=6,a.uploadFile({filePath:e.tempFilePaths[n],cloudPath:Date.now()+"."+i,onUploadProgress:function(t){console.log(t)}});case 6:o=t.sent,console.log(o);case 8:n++,t.next=1;break;case 11:case"end":return t.stop()}}),t)})));function e(e){return t.apply(this,arguments)}return e}(),fail:function(){}})},showImg:function(){var e=this;this.fileID?a.getTempFileURL({fileList:[this.fileID],success:function(t){e.imgUrl=t.fileList[0].tempFileURL,console.log(t)},fail:function(){t.showModal({content:"获取临时链接失败",showCancel:!1})}}):t.showModal({content:"请先上传一张图片",showCancel:!1})}}};e.default=c}).call(this,n("543d")["default"],n("a9ff")["default"])}},[["a959","common/runtime","common/vendor"]]]);